CREATE DATABASE BDTEC;
-- =====================================
-- CREACIÃ“N DE TABLAS
-- =====================================

CREATE TABLE TIPO_EMPLEADO (
    ID_TIPO INT NOT NULL,
    NOMBRE VARCHAR(50)
);

CREATE TABLE PLAZA (
    ID_PLAZA INT NOT NULL,
    HORARIO VARCHAR(50)
);

CREATE TABLE DEPARTAMENTO (
    ID_DEPARTAMENTO INT NOT NULL,
    CONTRA VARCHAR(50),
    CORREO VARCHAR(50)
);

CREATE TABLE EMPLEADO (
    ID_EMPLEADO INT NOT NULL,
    ID_PLAZA INT NOT NULL,
    ID_DEPARTAMENTO INT NOT NULL,
    ID_TIPO INT NOT NULL,
    NOMBRE VARCHAR(50),
    CORREO VARCHAR(50),
    CONTRASENA VARCHAR(50)
);

CREATE TABLE TIPO_ACTIVIDAD (
    ID_TIPO_ACTIVIDAD INT NOT NULL,
    NOMBRE VARCHAR(50),
    FECHA_INICIO DATE,
    FECHA_FIN DATE
);

CREATE TABLE ACTIVIDAD (
    ID_ACTIVIDAD INT NOT NULL,
    ID_TIPO_ACTIVIDAD INT,
    NOMBRE VARCHAR(50),
    REQUISITO VARCHAR(50)
);

CREATE TABLE EMPLEADOSXACTIVIDADES (
    ID_EMPLEADO INT NOT NULL,
    ID_ACT INT NOT NULL
);

-- =====================================
-- PRIMARY KEYS
-- =====================================

ALTER TABLE TIPO_EMPLEADO
ADD CONSTRAINT PK_TIPO_EMPLEADO PRIMARY KEY (ID_TIPO);

ALTER TABLE PLAZA
ADD CONSTRAINT PK_PLAZA PRIMARY KEY (ID_PLAZA);

ALTER TABLE DEPARTAMENTO
ADD CONSTRAINT PK_DEPARTAMENTO PRIMARY KEY (ID_DEPARTAMENTO);

ALTER TABLE EMPLEADO
ADD CONSTRAINT PK_EMPLEADO PRIMARY KEY (ID_EMPLEADO);

ALTER TABLE TIPO_ACTIVIDAD
ADD CONSTRAINT PK_TIPO_ACTIVIDAD PRIMARY KEY (ID_TIPO_ACTIVIDAD);

ALTER TABLE ACTIVIDAD
ADD CONSTRAINT PK_ACTIVIDAD PRIMARY KEY (ID_ACTIVIDAD);

ALTER TABLE EMPLEADOSXACTIVIDADES
ADD CONSTRAINT PK_EMPLEADOSXACTIVIDADES PRIMARY KEY (ID_EMPLEADO, ID_ACT);

-- =====================================
-- FOREIGN KEYS
-- =====================================

ALTER TABLE EMPLEADO
ADD CONSTRAINT FK_EMPLEADO_PLAZA FOREIGN KEY (ID_PLAZA)
REFERENCES PLAZA(ID_PLAZA);

ALTER TABLE EMPLEADO
ADD CONSTRAINT FK_EMPLEADO_DEPARTAMENTO FOREIGN KEY (ID_DEPARTAMENTO)
REFERENCES DEPARTAMENTO(ID_DEPARTAMENTO);

ALTER TABLE EMPLEADO
ADD CONSTRAINT FK_EMPLEADO_TIPO FOREIGN KEY (ID_TIPO)
REFERENCES TIPO_EMPLEADO(ID_TIPO);

ALTER TABLE ACTIVIDAD
ADD CONSTRAINT FK_ACTIVIDAD_TIPO_ACTIVIDAD FOREIGN KEY (ID_TIPO_ACTIVIDAD)
REFERENCES TIPO_ACTIVIDAD(ID_TIPO_ACTIVIDAD);

ALTER TABLE EMPLEADOSXACTIVIDADES
ADD CONSTRAINT FK_EMPLEADOSXACTIVIDADES_EMPLEADO FOREIGN KEY (ID_EMPLEADO)
REFERENCES EMPLEADO(ID_EMPLEADO);

ALTER TABLE EMPLEADOSXACTIVIDADES
ADD CONSTRAINT FK_EMPLEADOSXACTIVIDADES_ACTIVIDAD FOREIGN KEY (ID_ACT)
REFERENCES ACTIVIDAD(ID_ACTIVIDAD);

-- =====================================
-- CHECKS y DEFAULTS (ejemplos)
-- =====================================

ALTER TABLE EMPLEADO
ADD CONSTRAINT CHK_CORREO CHECK (CORREO LIKE '%@%');

ALTER TABLE PLAZA
ADD CONSTRAINT CHK_HORARIO CHECK (HORARIO IS NOT NULL);
